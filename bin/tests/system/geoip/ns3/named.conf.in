/*
 * Copyright (C) 2014  Internet Systems Consortium, Inc. ("ISC")
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES WITH
 * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,
 * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
 * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE
 * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
 * PERFORMANCE OF THIS SOFTWARE.
 */

// NS3

controls { /* empty */ };

options {
	query-source address 10.53.0.3;
	notify-source 10.53.0.3;
	transfer-source 10.53.0.3;
	port @PORT@;
	pid-file "named.pid";
	listen-on { 10.53.0.3; };
	listen-on-v6 { fd92:7065:b8e:ffff::3; };
	recursion no;
	geoip-directory "../ecsdata";	/* contains GeoIP.dat only */
	geoip-use-ecs yes;              /* default */

};

key rndc_key {
	secret "1234abcd8765";
	algorithm hmac-sha256;
};

controls {
	inet 10.53.0.3 port @CONTROLPORT@ allow { any; } keys { rndc_key; };
};

# Iceland 10.53.0.0
view IS {
	match-clients { geoip db country country IS; };
	zone "test.example" {
		type master;
		file "test.example-IS.db";
	};
};

# Australia 10.53.0.1
view AU {
	match-clients { geoip db country country AU; };
	zone "test.example" {
		type master;
		file "test.example-AU.db";
	};
};

# Canada
# not using geoip database, it is using "ecs"
# if was using geoip, it is 10.53.0.3 - 10.53.0.6
# Note order of these views, so some will match IS and AU above first.
view CA {
        match-clients { ecs 10.53.0/24 ; };
	zone "test.example" {
		type master;
		file "test.example-CA.db";
	};
};

# United States 10.53.0.7  and 10.53.1.4 - 10.53.1.7
view US {
	match-clients { geoip db country country US; };
	zone "test.example" {
		type master;
		file "test.example-US.db";
	};
};

# note that I don't have a view with match-clients for geoip
# for JP Japan 10.53.1.1 - 10.53.1.3
# so should fall through to the "none" view

# Germany 10.53.2.0 - 10.53.2.255
view DE {
	match-clients { geoip db country country DE; };
	zone "test.example" {
		type master;
		file "test.example-DE.db";
	};
};

view none {
	zone "test.example" {
		type master;
		file "test.example-none.db";
	};
};
